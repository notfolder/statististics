---
title: "統計学入門 輪講 1章 2章"
author: "平野 哲"
date: "2019/5/12"
output:
  ioslides_presentation: default
  html_dokument: default
  word_document: default
  slidy_presentation: default
  beamer_presentation: default
  html_notebook: default
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(formattable)
#library(DT)

transpose <- function(x) {
  tmp <- data.frame(t(x))
#  colnames(tmp) <- tmp[1,]
  tmp <- tmp[-1,]
  return (tmp)
}
```

# 第1章 統計学の基礎(p.1)

「比較級や最上級の言葉のみを用いたり,思弁的な議論をするかわりに,私は自分のいわんとするところを,
数・重量・尺度を用いて表現した」（ベティー『政治算術』）


## 1.1 統計学とは(p.1)

### 1.1.1 統計的なものの見方(p.1)

* **統計学 statistics**の成り立ちについて
* 記述統計
    - 現象の法則性を知るために,すべてを丹念に調べ,規則性から法則生を見出す
* 推測統計
    - 一部を観察して,そこから論理性のある推測で全体の法則性の発見に至る

---

### 1.1.2 近代統計学の成立(p.5)

近代統計学成立の歴史的な紹介。詳細な説明はないため、重要と思われる単語の記載に止める

* **「回帰」** **「相関」** の発見
* 相関の考え方は積率相関係数(今日の**「相関係数」**)によって明確なものになった

$$
r=\frac{\sum (x_{i}-\overline{x})(y_{i}-\overline{y})}
  {\sqrt{\sum (x_{i}-\overline{x})^2} \cdot \sqrt{\sum (y_{i}-\overline{y})^2}}
$$

以下のような概念が成立していった.

* 標準偏差
* 頻度分布
* 標本(sample)

---

* 母集団(population)
* 統計的推測(statistical inference)
* 推定(estimation)
* 仮説検定(hypothesis testing)
* 観測された値$r$の分布 **(標本分布sampling distribution)** が厳密に計算でき,それから重要な判断ができる
* 確率論により、 **標本による調査** が可能となる

## 1.2 統計データと統計手法(p.8)

### 1.2.1 量的データと質的データ(p.8)

* データが定量的な値で与えられるものを**量的データ**と呼ぶ
* 数値として観測することができず,あるカテゴリーに属していることや,ある状態にあることだけがわかるデータを**質的データ**という

* 量的データの例
```{r 身長, echo=FALSE}
身長 <- c(178,165,168,152,175,175,165,162,164,170,169,155,153,162,168)
学生 <- 1:15
量的データ <- data.frame(学生=学生,身長=身長)
#量的データ横 <- data.frame(t(量的データ))
#colnames(量的データ横) <- 学生
#量的データ横 <- 量的データ横[-1,]
量的データ横 <- transpose(量的データ)
formattable::formattable(量的データ横,rownames = FALSE, colnames = FALSE,caption = "統計学を履修した学生15人の身長")
#DT::datatable(量的データ横,rownames = FALSE,caption = "統計学を履修した学生15人の身長")
```

---

* 質的データの例

```{r 性別, echo=FALSE}
性別 <- c("男","男","男","女","男","男","男","女","女","男","男","女","女","女","男")
質的データ <- data.frame(学生=学生,性別=性別)
質的データ横 <- transpose(質的データ)
formattable::formattable(質的データ横,rownames = FALSE,caption = "統計学を履修した学生15人の性別")
```

統計学では,量的データばかりでなく質的データに対しても各種の手法があり,これらのデータ分析を行い有用な情報を得ることができる.

---

### 1.2.2 1次元データと多次元データ(p.9)

* 一人の学生に対して一つの観測値(身長)だけが与えられているようなデータを**一次元データ 1-dimensional data**と呼ぶ.
* 一人の学生に対して二つの観測値(身長と体重)が与えられているようなデータを**二次元データ 2-dim. data**と呼ぶ.
* もう一つ観測値が増えれば(身長,体重,性別)**三次元データ 3-dim. data**と呼ぶ
* 統計学では2次元以上のデータを一次元データに対して**多次元データ multi-dimensional data**呼ぶ

```{r 二次元データ, echo=FALSE}
体重 <- c(63,62,69,41,71,61,62,48,52,55,69,48,44,49,69)
二次元データ <- data.frame(学生=学生,身長=身長,体重=体重)
二次元データ横 <- transpose(二次元データ)
formattable::formattable(二次元データ横,rownames = FALSE,caption = "統計学を履修した学生15人の身長と体重")
```


---

### 1.2.3 時系列データとクロス・セクション・データ(p.9)

* 同一の対象(日本の人口等)の異なった時点での観測値からなるデータを**時系列データ time series data**と呼ぶ
* いくつかの異なった対象について調査・実験を行い,観測値を得た場合のデータを**クロスセクション・データ cross-section data**と呼ぶ
* 定めた一定範囲の対象に対して時系列データを集めたものを**パネル・データ panel data**と呼ぶ

## 1.3 統計データの分析プロセス(p.11)

* 仮設を構築し,分析する
* 分析に必要なデータを収集することを自然科学では**実験 experiment**,社会科学の分野では**調査 survey**と呼ぶ
* 何らかの統計処理を施した後の調査結果を**統計資料**とよぶ
* 統計資料は**第一義統計**と**第二義統計**に分類される
* **第一義統計**はあらかじめ統計資料を作成する目的で調査を行い,その結果を集計したもの
* **第二義統計**は**業務統計**とも呼ばれ,統計資料が目的ではない資料を集計して得た統計資料
* 統計資料を加工して作成された統計資料を**二次統計**と呼ぶ

---

* 源データが無い統計資料を参考にする場合、下記に注意する
    * 誰が調査を行ったものか,だれ(何)を対象としたものか
    * **全数調査**か**標本調査**か
    * いつの時点のものか,どの地域を対象としたものか,分類の定義はどうなっているか

---

統計データの分析プロセスは下記の順序になる

1. 仮説を構築する
2. 分析に必要なデータを集める
3. コンピューターの**パッケージ(統計ソフト)**を用いて計算する
4. 計算結果を解釈し,それを適切に表現する

---

### 第1章練習問題(p.15)
★練習問題の答えを書く

# 第2章 1次元のデータ(p.17)
データは情報の宝庫である.
これを取り出すには,二つの方法がある.
一つは,グラフにして総合的にとらえる方法,
もう一つは,数量的に要約し,アプローチする方法である.

---

* 「データ」を**正しく**しかも**効率的**に読む方法として**記述統計学 descriptive statistics**と呼ばれている方法がある
* **記述統計学**とは集団としての特徴を記述するために,観測対象となった各個体について観測し,得られたデータを整理・要約する方法
* **観測 observation**とは調査や実験のこと
* 各「個体」の観測値をまとめたものを**データ data**という.

## 2.1 度数分布とヒストグラム(p.18)

* 観測値の取りうる値をいくつかの**階級 class**に分け,それぞれの階級で観測値がいくつあるか**度数 frequency**を数えて,表にしたもの
★度数分布表の例
* **階級値**とは階級を代表する値,上限値と下限値の中間地を使うのが一般的
* **相対度数 relative frequency**とは各階級に属する観測値の個数の全体中での割合を示す
* **累積度数 cumulative frequency** **累積相対度数 cumulative relative frequency**とは度数をしたの階級から順に積み上げた時の度数,相対度数
* 度数分布表から**ヒストグラム histogram**や**柱状グラフ**というグラフを書く
★ヒストグラムの例

---

* ヒストグラムを書くことによって,データの分布系を知ることができ,分布には様々な形がある
* 中央に一つ峰がある分布を山型分布という
* 峰が中央から左に寄っていて,右側に長く裾を引く分布を**右に歪んだ分布**という
* データによっては峰が二つ以上ある分布(**双峰型 bimodal**)になる場合もある
* 適切にグループ分けすると峰が一つの単純な分布(**単峰型 unimodal**)になることが多い
* このような操作を**層別**という

---

* 度数分布表やヒストグラムを作成するときに**階級数**の問題と**階級幅**の問題に注意する
* 階級をどのようにとるかを決める統一的なルールはないが,階級数については**スタージェス**の公式が参考になる,観測値の数を$n$としたとき、階級数$k$としては下記の式の通りにすると良い

$$
k \fallingdotseq 1+\log_{2}n=1+(\log_{10}n)/(\log_{10}2)
$$

* 最初の階級に下限値がなく,最後の階級に上限値がないものを「両端の開いた分布」という

---

* 累積度数を組み合わせて書いた折れ線を**ローレンツ曲線 Lorenz curve**と呼ぶ

* **測定の尺度**
* **測定 measurement**が依っている基準を**4尺度 scales**に分類することがある
    * 名義尺度 nominal scale
      ある個体が他と異なるか同一かという判断の基準(’男’,'女'など)

    * 順序尺度 ordinal scale
      ある個体が他より'大きい','良い','多い'と言える判断の基準('良い','中程度','悪い'など)

    * 間隔尺度 interval scale
      ある個体は他よりもある単位によって～だけ多いと言えるといえる判断の基準(温度や時刻など,間隔のみが意味を持つ)

    * 比尺度 raito scale
      ある個体は他よりある単位によって～倍だけ多いといえる判断の基準(長さや重さ,時間の経過など)

## 2.2 代表値(p.28)

* **代表値 averages**とは,分布を代表する値
* **平均 mean**にはいくつかの種類がある
    * 算術平均 arithmetic mean
    * 幾何平均 geometric mean
    * 調和平均 harmonic mean

---

* **算術平均**がもっともよく知られている.算術平均は観測値$x_1{1},x_{2},\cdots,x_{n}$の和を観測値の総数$n$で割ったもので、下記の式で定義される
$$
\overline{x}=\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}
$$
* 算術平均は,定義より$\sum_{i}(x_{i}-\overline{x})=0$が成り立つ

---

* 観測値の取りうる値を$v_{1},v_{2},\cdots,v_{k}$とし,それぞれの度数が$f_{1},f_{2},\cdots,f_{k}$であるとき,下記の式で平均を近似的に求めることができる

$$
\overline{x}=\frac{f_{1}v_{1}+f_{2}v_{2}+\cdots+f_{k}v_{k}}{f_{1}+f_{2}+\cdots+f_{k}}
$$

* また,度数分布表から平均を求める時,上式の$v_{i}$を$i$階級の階級値に置き換えれば良い
* 両端の開いた度数分布から平均を求める場合、下記2つの方法が考えられている

    1. 両端の階級を**異常値**(**外れ値 outlier**という言い方とほぼ同じ)として除いて計算する
    2. 最初と最後の階級に対して階級値を適当に決めて与える

---

* **幾何平均**は下記の式で定義される
$$
x_{G}=\sqrt[n]{x_{1}\cdot x_{2}\cdot \cdots \cdot x_{3}}
$$
地価の年平均上昇率などに用いる.

* **調和平均**は下記の式で定義される
$$
\frac{1}{x_{H}}=\frac{1}{n}(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}})
$$
移動速度が違う場合の平均速度などに用いる.

* **メディアン median** **中位数**または**中央値**として知られる代表値で、観測値を小さいものから順番に並び替えた時の,中央の値
* 観測値が偶数個$n=2m$の場合は中央が一つに決まらないので、$m$番目と$m+1$番目の観測値$x_{m}$と$x_{m+1}$の平均$(x_{m}+x_{m+1})/2$をメディアンとする

---

* **中分位**メディアンの考え方を拡張し,中心でない位置の値を代表とする
    * **100pパーセンタイル percentile** **(百)分位点**ともいう,観測値を小さい順番に並び替えた時の小さい方から$100p\%(0\leqq p \leqq 1)$の所にある値
    * **四分位点 quartile** 小さいもの順に並び帰られたデータを4等分したときの三つの分割点でありそれぞれ下記になる
        * **第1四分位点$Q_{1}$**は25%分位点
        * **第2四分位点$Q_{2}$**は50%分位点(メディアン)
        * **第3四分位点$Q_{2}$**は75%分位点
* 度数分布表からメディアンや分位点の近似値を求めることもできる

---

* **モード mode** **最頻値**つまり分布の峰に対応する値,度数分布表においては,その度数が最大である階級の階級値

* 平均,メディアン,モードは峰が一つで分布が左右対称の場合は完全に一致する
* 分布が左右対称ではなく,峰が中心より左側に寄っていて,右側の裾が長い右に歪んだ分布では,一般的に$Mean \gt Median \gt Mode$となる

---

* **ミッド・レンジ mid-range** 分布の最大値$x_{n}$と最小値$x_{1}$の間の範囲の中間点で,下記式で定義される
$$
M=\frac{1}{2}\{max(x_{1},x_{2},\cdots,x_{n})+min(x_{1},x_{2},\cdots,x_{n})\}
$$

## 2.3 散らばりの尺度(p.35)

* 平均,メディアン,モードで区別できない分布を示すための他の指標が必要であり,よく用いられるのは**散らばり dispersion**の尺度である
* **レンジ range** **範囲**とも呼ばれ,下記で定義される,つまり分布の端から端までの距離である

$$
R=max(x_{1},x_{2},\cdots,x_{n})-min(x_{1},x_{2},\cdots,x_{n})
$$

* 散らばりの尺度としてかなり荒いので,特殊な場合を除いてあまり用いられない

---

* **四分位偏差 quartile deviation, semi-interquartile range**　レンジを改良したもので,第3四分位点$Q_{3}$と第1四分位点$Q_{1}$の隔たりの半分として下記式で定義される
$$
Q=\frac{1}{2}(Q_{3}-Q_{1})
$$
真ん中の半分のデータが散らばっている範囲の平均を表す

----

* **偏差 deviation** 各観測値$x_{i}$と平均$\overline{x}$との隔たりをいう
* **平均偏差 mean deviation** 各観測値が平均からどれだけ離れているかについての平均を求めたもの,描きで求められる
$$
d=\frac{1}{n}\{|x_{1}-\overline{x}|+|x_{2}-\overline{x}|+\cdots+ |x_{n}-\overline{x}|\}
$$
* 平均からの偏差を加え合わせると常に0となる

---

* **分散 variance**　偏差を絶対値でなくて,2乗することで符号を消し,平均を求めたもので下記式で定義される
$$
S^{2}=\frac{1}{n}\{(x_{1}-\overline{x})^2+(x_{2}-\overline{x})^2+\cdots+(x_{n}-\overline{x})^2\}
$$
* $\{\}$の中はしばしば次式になる

$$
(x_{1}-\overline{x})^2+(x_{2}-\overline{x})^2+\cdots+(x_{n}-\overline{x})^2=
x_{1}^{2}+\cdots+x_{n}^{2}-n\overline{x}^{2}
$$

---

* **標準偏差 standard deviation** 分散の平方根をとった$S$すなわち$S=\sqrt{S^2}$である
* 度数分布表から標準偏差を求める場合は下記になる

$$
S^{2}=\frac{f_{1}(v_{1}-\overline{x})^2+\cdots+f_{k}(v_{k}-\overline{x})^2}{f_{1}+\cdots+f_{k}}
$$

---

* **変動係数 coefficient of variation** 下記式で与えられる指標で,分散をもって分布の散らばり具合を比較できない場合に用いる

$$
C.V.=S_{x}/\overline{x}
$$

---

* **標準得点 standard score** **標準化 standardization**ともいい,データを$x_{i}=ax_{i}+b$のように変換した場合で特に重要な変換であり,$a=1/S_{x},b=-\overline{x}/S_{x}$の場合で,下記で与えられる変換である
$$
z_{i}=\frac{x_{i}-\overline{x}}{S_{x}}
$$
* **偏差値得点** 標準得点に下記一次変換を行ったもの
$$
T_{i}=10z_{i}+50
$$

---

#### 第2章 練習問題(p.39)
★

★用語の英語表記を記載
